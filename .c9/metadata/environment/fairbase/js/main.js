{"filter":false,"title":"main.js","tooltip":"/fairbase/js/main.js","undoManager":{"mark":17,"position":17,"stack":[[{"start":{"row":0,"column":0},"end":{"row":15,"column":3},"action":"remove","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// ログイン状態の変化を監視する","firebase.auth().onAuthStateChanged(function(user) {","  if (user) {","    console.log(\"ログインしました\");","  } else {","    console.log(\"ログインしていません\");","","    firebase.auth().signInAnonymously()   // 匿名ログインの実行","    .catch(function(error) {              // ログインに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  }","});"],"id":2},{"start":{"row":0,"column":0},"end":{"row":18,"column":3},"action":"insert","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// ログイン状態の変化を監視する","firebase.auth().onAuthStateChanged(function(user) {","  if (user) {","    console.log(\"ログインしました\");","    ","    // mykeyにデータを保存する","    firebase.database().ref(\"mykey\").set(\"myvalue\");","  } else {","    console.log(\"ログインしていません\");","","    firebase.auth().signInAnonymously()   // 匿名ログインの実行","    .catch(function(error) {              // ログインに失敗したとき���処理","      console.error(\"ログインエラー\", error);","    });","  }","});"]}],[{"start":{"row":9,"column":52},"end":{"row":10,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":10,"column":0},"end":{"row":10,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":10,"column":4},"end":{"row":10,"column":7},"action":"insert","lines":["// "],"id":4}],[{"start":{"row":10,"column":6},"end":{"row":10,"column":7},"action":"remove","lines":[" "],"id":5},{"start":{"row":10,"column":5},"end":{"row":10,"column":6},"action":"remove","lines":["/"]},{"start":{"row":10,"column":4},"end":{"row":10,"column":5},"action":"remove","lines":["/"]}],[{"start":{"row":10,"column":4},"end":{"row":10,"column":7},"action":"insert","lines":["// "],"id":6}],[{"start":{"row":10,"column":7},"end":{"row":10,"column":8},"action":"insert","lines":["r"],"id":7},{"start":{"row":10,"column":8},"end":{"row":10,"column":9},"action":"insert","lines":["e"]},{"start":{"row":10,"column":9},"end":{"row":10,"column":10},"action":"insert","lines":["f"]}],[{"start":{"row":10,"column":10},"end":{"row":10,"column":11},"action":"insert","lines":["は"],"id":8},{"start":{"row":10,"column":11},"end":{"row":10,"column":13},"action":"insert","lines":["操作"]}],[{"start":{"row":10,"column":13},"end":{"row":10,"column":15},"action":"insert","lines":["対象"],"id":9}],[{"start":{"row":10,"column":15},"end":{"row":10,"column":16},"action":"insert","lines":[" "],"id":10}],[{"start":{"row":10,"column":16},"end":{"row":10,"column":20},"action":"insert","lines":["せっとで"],"id":11}],[{"start":{"row":10,"column":20},"end":{"row":10,"column":21},"action":"insert","lines":["値"],"id":12}],[{"start":{"row":0,"column":0},"end":{"row":19,"column":3},"action":"remove","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// ログイン状態の変化を監視する","firebase.auth().onAuthStateChanged(function(user) {","  if (user) {","    console.log(\"ログインしました\");","    ","    // mykeyにデータを保存する","    firebase.database().ref(\"mykey\").set(\"myvalue\");","    // refは操作対象 せっとで値","  } else {","    console.log(\"ログインしていません\");","","    firebase.auth().signInAnonymously()   // 匿名ログインの実行","    .catch(function(error) {              // ログインに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  }","});"],"id":13},{"start":{"row":0,"column":0},"end":{"row":42,"column":3},"action":"insert","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// 初期値を設定","var num = 0;","","// ログイン処理","firebase.auth().onAuthStateChanged(function(user) {","  if (user) {","    console.log(\"ログインしま��た\");","","    // 現在のmykeyの値を取得","    firebase.database().ref(\"mykey\").on(\"value\", function(snapshot) {","","      // データの取得が完了すると実行される","      if(snapshot.val() != null && !isNaN(snapshot.val())) {  // 取得した値が数値かを判定","        num = snapshot.val();","      }","","      console.log(\"got value: \" + num);","    });","  } else {","    console.log(\"ログインしていません\");","","    firebase.auth().signInAnonymously()   // 匿名ログインの実行","    .catch(function(error) {              // ログインに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  }","});","","// イベントハンドラの登録など","// jQueryの操作が必要な処理をココに入れる","$(document).ready(function() {","  // id=\"my-button\"をクリックしたらmykeyの値を+1","  $(\"#my-button\").click(function() {","    num++;","    console.log(\"set: \" + num);","","    // Firebase上のmykeyの値を更新","    firebase.database().ref(\"mykey\").set(num);","  });","});"]}],[{"start":{"row":42,"column":3},"end":{"row":43,"column":0},"action":"insert","lines":["",""],"id":14}],[{"start":{"row":0,"column":0},"end":{"row":43,"column":0},"action":"remove","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// 初期値を設定","var num = 0;","","// ログイン処理","firebase.auth().onAuthStateChanged(function(user) {","  if (user) {","    console.log(\"ログインしました\");","","    // 現在のmykeyの値を取得","    firebase.database().ref(\"mykey\").on(\"value\", function(snapshot) {","","      // データの取得が完了すると実行される","      if(snapshot.val() != null && !isNaN(snapshot.val())) {  // 取得した値が数値かを判定","        num = snapshot.val();","      }","","      console.log(\"got value: \" + num);","    });","  } else {","    console.log(\"ログインしていません\");","","    firebase.auth().signInAnonymously()   // 匿名ログインの実行","    .catch(function(error) {              // ログインに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  }","});","","// イベントハンドラの登録など","// jQueryの操作が必要な処理をココに入れる","$(document).ready(function() {","  // id=\"my-button\"をクリックしたらmykeyの値を+1","  $(\"#my-button\").click(function() {","    num++;","    console.log(\"set: \" + num);","","    // Firebase上のmykeyの値を更新","    firebase.database().ref(\"mykey\").set(num);","  });","});",""],"id":15},{"start":{"row":0,"column":0},"end":{"row":78,"column":3},"action":"insert","lines":["/* jshint curly:true, debug:true */","/* globals $, firebase, location */","","// 初期値を設定","var num = 0;","","// ログインユーザのUID","var currentUID = null;","","// イベントハンドラの登録など","// jQueryの操作が必要な処理をココに入れる","$(document).ready(function() {","","  // ログイン処理","  firebase.auth().onAuthStateChanged(function(user) {","    if (user) {","      console.log(\"状態：ログイン中\");","      currentUID = user.uid;","      ","      $(\".visible-on-login\").removeClass(\"hidden-block\");","      $(\".visible-on-login\").addClass(\"visible-block\");","      $(\".visible-on-logout\").removeClass(\"visible-block\");","      $(\".visible-on-logout\").addClass(\"hidden-block\");","  ","      // 現在のmykeyの値を取得","      firebase.database().ref(\"mykey\").on(\"value\", function(snapshot) {","  ","        // データの取得が完了すると実行される","        if(snapshot.val() != null && !isNaN(snapshot.val())) {  // 取得した値が数値かを判定","          num = snapshot.val();","        }","  ","        console.log(\"got value: \" + num);","      });","    } else {","      console.log(\"状態：ログアウト\");","      currentUID = null;","      ","      $(\".visible-on-login\").removeClass(\"visible-block\");","      $(\".visible-on-login\").addClass(\"hidden-block\");","      $(\".visible-on-logout\").removeClass(\"hidden-block\");","      $(\".visible-on-logout\").addClass(\"visible-block\");","    }","  });","","  // id=\"my-button\"をクリックしたらmykeyの値を+1","  $(\"#my-button\").click(function() {","    num++;","    console.log(\"set: \" + num);","","    // Firebase上のmykeyの値を更新","    firebase.database().ref(\"mykey\").set(num);","  });","","  // id=\"login-button\"をクリックしたらログイン処理","  $(\"#login-button\").click(function() {","    var mail = $(\"#user-mail\").val();","    var pass = $(\"#user-pass\").val();","","    firebase.auth().signInWithEmailAndPassword(mail, pass)  // ログイン実行","    .then(function(user) {    // ログインに成功したときの処理","      console.log(\"ログインしました\", user);","    })","    .catch(function(error) {  // ログインに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  });","","  // id=\"logout-button\"をクリックしたらログアウト処理","  $(\"#logout-button\").click(function() {","    firebase.auth().signOut()   // ログアウト実行","    .then(function() {          // ログアウトに成功したときの処理","      console.log(\"ログアウトしました\");","    })","    .catch(function(error) {    // ログアウトに失敗したときの処理","      console.error(\"ログインエラー\", error);","    });","  });","});"]}],[{"start":{"row":77,"column":5},"end":{"row":78,"column":0},"action":"insert","lines":["",""],"id":16},{"start":{"row":78,"column":0},"end":{"row":78,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":78,"column":0},"end":{"row":79,"column":3},"action":"remove","lines":["  ","});"],"id":17},{"start":{"row":78,"column":0},"end":{"row":94,"column":3},"action":"insert","lines":["  // id=\"upload-image\"でファイルが選択されたらStorageにアップロード","  $(\"#upload-image\").change(function() {","    if ($(this)[0].files.length === 0) { // ファイルが選択されていないなら何もしない","      return;","    }","","    var file = $(this)[0].files[0];","    var filename = \"sample/test\";","    firebase.storage().ref(filename).put(file)  // ファイルアップロードを実行","    .then(function(snapshot) {  // アップロード処理に成功したときの処理","      console.log(snapshot);","    })","    .catch(function(error) {    // アップロード処理に失敗したときの処理","      console.error(\"ファイルアップロードエラー\", error);","    });","  });","});"]}],[{"start":{"row":79,"column":0},"end":{"row":93,"column":5},"action":"remove","lines":["  $(\"#upload-image\").change(function() {","    if ($(this)[0].files.length === 0) { // ファイルが選択されていないなら何もしない","      return;","    }","","    var file = $(this)[0].files[0];","    var filename = \"sample/test\";","    firebase.storage().ref(filename).put(file)  // ファイルアップロードを実行","    .then(function(snapshot) {  // アップロード処理に成功したときの処理","      console.log(snapshot);","    })","    .catch(function(error) {    // アップロード処理に失敗したときの処理","      console.error(\"ファイルアップロードエラー\", error);","    });","  });"],"id":18},{"start":{"row":79,"column":0},"end":{"row":101,"column":5},"action":"insert","lines":[" // id=\"upload-image\"でファイルが選択されたらStorageにアップロード","  $(\"#upload-image\").change(function() {","    if ($(this)[0].files.length === 0) { // ファイルが選択されていないなら何もしない","      return;","    }","","    var file = $(this)[0].files[0];","    var filename = \"sample/test\";","    firebase.storage().ref(filename).put(file)  // ファイルアップロードを実行","    .then(function(snapshot) {  // アップロード処理に成功したときの処理","    ","      firebase.storage().ref(filename).getDownloadURL() // 画像のURLを取得","      .then(function(url) {     // URLの取得に成功したときの処理","        $(\"#upload-image-preview\").attr(\"src\", url); // ページ上に画像を表示","      })","      .catch(function(error) {  // URLの取得に失敗したときの処理","        console.error(\"URL取得エラー\", error);","      });","    })","    .catch(function(error) {    // アップロード処理に失敗したときの処理","      console.error(\"ファイルアップロードエラー\", error);","    });","  });"]}],[{"start":{"row":78,"column":0},"end":{"row":79,"column":0},"action":"remove","lines":["  // id=\"upload-image\"でファイルが選択されたらStorageにアップロード",""],"id":19}]]},"ace":{"folds":[],"scrolltop":540,"scrollleft":0,"selection":{"start":{"row":46,"column":36},"end":{"row":46,"column":36},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":37,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1542090387752,"hash":"47a55246de58311442a2b565f049b7d4eefb08f2"}